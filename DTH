this code is for dth 
updated code for dth
